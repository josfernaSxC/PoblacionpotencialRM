
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Visualizador de Población por Comuna</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body style="font-family: Arial; max-width: 800px; margin: auto; padding: 20px;">

<h2>Visualizador de Población Potencial por Comuna y Rango Etario</h2>

<label for="comuna-select">Selecciona una comuna:</label>
<select id="comuna-select"></select>

<div id="plot" style="margin-top: 30px;"></div>

<script>
const dataPorComuna = {'Santiago': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [5381.5, 4967.0, 4545.0, 4165.0, 3883.5, 3744.0, 3735.5, 3739.0, 3627.0, 3468.0, 3370.0, 3315.5, 3272.0, 3233.5, 3290.5, 3608.0, 4246.5]}, 'Cerrillos': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1182.5, 1178.5, 1150.5, 1110.0, 1083.0, 1087.5, 1123.5, 1156.5, 1151.5, 1127.5, 1123.0, 1131.5, 1138.0, 1124.5, 1097.5, 1093.0, 1123.5]}, 'Cerro Navia': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1752.5, 1753.0, 1723.0, 1661.5, 1608.0, 1599.0, 1653.5, 1725.5, 1748.5, 1739.5, 1743.5, 1759.0, 1776.0, 1782.0, 1767.0, 1743.0, 1727.5]}, 'Conchalí': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1628.5, 1617.0, 1583.0, 1532.0, 1495.0, 1499.5, 1555.5, 1616.0, 1615.5, 1575.5, 1552.0, 1554.5, 1581.0, 1602.5, 1595.0, 1570.0, 1556.0]}, 'El Bosque': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [2118.5, 2098.5, 2083.5, 2081.0, 2095.5, 2137.0, 2207.0, 2252.0, 2213.0, 2147.5, 2133.5, 2151.0, 2173.0, 2179.0, 2161.5, 2133.5, 2105.0]}, 'Estación Central': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [2527.5, 2477.5, 2418.0, 2337.5, 2247.5, 2215.5, 2257.0, 2300.5, 2267.0, 2196.5, 2176.0, 2186.5, 2207.0, 2212.0, 2209.0, 2244.5, 2342.0]}, 'Huechuraba': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1664.0, 1687.5, 1696.0, 1679.5, 1665.0, 1686.5, 1757.5, 1827.0, 1826.0, 1786.5, 1761.0, 1746.5, 1741.0, 1723.0, 1673.0, 1592.0, 1503.5]}, 'Independencia': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1941.0, 1827.0, 1716.5, 1619.5, 1547.0, 1516.5, 1528.5, 1537.0, 1489.0, 1421.5, 1394.0, 1397.0, 1407.0, 1404.5, 1393.0, 1403.0, 1458.5]}, 'La Cisterna': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1138.5, 1127.0, 1109.0, 1088.0, 1077.5, 1089.5, 1128.0, 1161.0, 1154.0, 1118.0, 1090.5, 1074.0, 1072.0, 1077.5, 1075.5, 1072.0, 1073.0]}, 'La Florida': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [4589.0, 4609.0, 4589.5, 4512.0, 4442.5, 4457.0, 4581.5, 4709.5, 4700.0, 4652.0, 4679.5, 4743.5, 4804.5, 4830.0, 4793.5, 4712.5, 4627.5]}, 'La Granja': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1480.5, 1473.0, 1446.5, 1404.0, 1370.5, 1365.5, 1396.0, 1433.0, 1432.0, 1417.0, 1425.5, 1448.5, 1474.5, 1490.5, 1486.5, 1468.5, 1448.0]}, 'La Pintana': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [2822.0, 2823.5, 2780.0, 2700.5, 2652.0, 2679.0, 2777.0, 2862.0, 2845.0, 2786.0, 2766.5, 2762.5, 2751.5, 2717.0, 2662.0, 2603.0, 2547.0]}, 'La Reina': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1013.0, 1058.0, 1085.5, 1086.5, 1077.5, 1081.5, 1107.0, 1138.5, 1148.0, 1159.5, 1190.5, 1220.0, 1234.0, 1232.5, 1217.5, 1198.0, 1183.0]}, 'Las Condes': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [3590.0, 3460.5, 3319.5, 3179.5, 3073.0, 3045.5, 3111.0, 3199.0, 3209.5, 3184.5, 3202.5, 3238.5, 3282.5, 3318.0, 3359.0, 3451.5, 3620.0]}, 'Lo Barnechea': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1651.5, 1740.0, 1821.0, 1866.5, 1892.5, 1943.0, 2051.5, 2170.5, 2211.0, 2201.5, 2207.5, 2229.5, 2246.5, 2237.5, 2184.0, 2103.5, 2023.0]}, 'Lo Espejo': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1255.0, 1259.0, 1253.5, 1238.0, 1224.5, 1229.0, 1254.5, 1271.0, 1246.0, 1209.0, 1196.5, 1200.0, 1216.5, 1238.5, 1250.0, 1243.0, 1226.0]}, 'Lo Prado': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1153.0, 1140.0, 1121.5, 1100.0, 1086.5, 1102.5, 1148.5, 1187.5, 1179.0, 1148.0, 1142.0, 1155.0, 1170.0, 1171.5, 1161.0, 1157.0, 1164.0]}, 'Macul': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1503.5, 1465.0, 1427.0, 1387.0, 1355.5, 1347.5, 1377.5, 1419.5, 1423.5, 1408.5, 1411.5, 1430.0, 1452.5, 1458.0, 1434.5, 1407.5, 1404.5]}, 'Maipú': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [6852.0, 6938.5, 6919.5, 6816.0, 6747.5, 6825.5, 7075.5, 7324.0, 7362.0, 7326.0, 7426.5, 7590.5, 7746.5, 7829.5, 7817.0, 7761.0, 7686.0]}, 'Ñuñoa': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [2903.5, 2799.5, 2654.0, 2470.0, 2325.5, 2251.0, 2252.5, 2267.5, 2218.5, 2152.5, 2136.5, 2159.0, 2188.5, 2194.0, 2187.5, 2202.0, 2258.0]}, 'Pedro Aguirre Cerda': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1161.0, 1176.5, 1179.5, 1164.0, 1144.0, 1139.0, 1159.0, 1179.0, 1164.5, 1134.0, 1123.5, 1134.0, 1156.5, 1172.5, 1168.5, 1156.5, 1147.0]}, 'Peñalolén': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [3247.0, 3298.5, 3320.5, 3314.5, 3328.5, 3406.0, 3557.5, 3682.0, 3674.0, 3625.0, 3649.0, 3713.0, 3768.5, 3787.5, 3748.5, 3681.0, 3623.0]}, 'Providencia': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1704.5, 1557.0, 1407.5, 1275.0, 1182.5, 1135.5, 1123.5, 1111.5, 1070.5, 1030.0, 1018.0, 1012.5, 999.0, 980.5, 992.0, 1067.5, 1211.0]}, 'Pudahuel': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [3470.0, 3512.5, 3512.0, 3442.5, 3355.5, 3334.0, 3423.0, 3532.0, 3534.0, 3478.5, 3479.0, 3502.0, 3505.5, 3463.5, 3382.0, 3313.0, 3273.5]}, 'Quilicura': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [3765.0, 3771.5, 3754.5, 3713.0, 3712.5, 3810.5, 4011.5, 4187.5, 4211.5, 4170.0, 4197.0, 4261.0, 4316.5, 4314.5, 4211.0, 4043.0, 3866.0]}, 'Quinta Normal': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1598.5, 1576.0, 1547.5, 1513.5, 1492.0, 1503.0, 1545.5, 1578.0, 1559.0, 1521.0, 1499.5, 1488.0, 1502.5, 1535.5, 1560.0, 1570.5, 1577.5]}, 'Recoleta': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [2303.5, 2274.5, 2224.0, 2156.5, 2111.0, 2120.0, 2190.0, 2252.5, 2236.0, 2185.0, 2163.0, 2159.0, 2157.5, 2156.0, 2147.0, 2146.0, 2170.5]}, 'Renca': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [2263.5, 2264.0, 2243.0, 2200.0, 2164.5, 2173.0, 2240.5, 2303.0, 2283.5, 2212.5, 2170.0, 2166.0, 2194.0, 2221.5, 2202.0, 2144.0, 2070.5]}, 'San Joaquín': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1147.5, 1148.5, 1120.5, 1074.0, 1042.5, 1048.0, 1086.0, 1118.0, 1106.5, 1078.5, 1071.5, 1085.0, 1111.0, 1130.0, 1132.0, 1131.0, 1141.5]}, 'San Miguel': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1750.0, 1651.0, 1560.0, 1480.0, 1421.0, 1392.5, 1402.5, 1419.5, 1404.0, 1377.0, 1372.0, 1380.5, 1392.5, 1390.5, 1364.5, 1335.5, 1330.5]}, 'San Ramón': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1039.0, 1021.5, 989.5, 946.5, 916.5, 918.5, 955.0, 994.5, 1003.0, 994.0, 995.0, 1008.0, 1032.5, 1056.5, 1061.0, 1046.0, 1023.0]}, 'Vitacura': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1119.5, 1120.0, 1126.0, 1095.0, 1043.5, 1025.5, 1050.0, 1087.5, 1098.5, 1092.0, 1096.0, 1100.0, 1099.0, 1091.0, 1073.5, 1053.5, 1036.5]}, 'Puente Alto': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [9108.5, 9119.5, 9003.0, 8797.5, 8678.0, 8781.0, 9110.5, 9404.0, 9369.5, 9199.5, 9181.5, 9255.5, 9341.5, 9364.0, 9256.0, 9060.5, 8834.0]}, 'Pirque': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [428.5, 435.0, 435.5, 429.0, 422.0, 423.0, 435.0, 446.5, 439.5, 427.5, 426.0, 431.5, 438.0, 438.5, 432.5, 419.5, 402.5]}, 'San José de Maipo': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [238.0, 235.0, 228.5, 220.5, 217.5, 223.0, 237.0, 250.5, 253.0, 250.0, 251.0, 256.5, 261.5, 260.5, 251.0, 236.0, 219.5]}, 'Colina': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [3410.0, 3472.5, 3487.5, 3429.5, 3350.5, 3314.5, 3356.5, 3394.0, 3318.0, 3191.5, 3104.0, 3039.5, 2987.0, 2923.0, 2815.0, 2664.5, 2502.0]}, 'Lampa': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [2483.5, 2496.0, 2458.0, 2381.5, 2318.0, 2313.5, 2377.0, 2438.0, 2402.0, 2319.5, 2265.0, 2223.5, 2177.0, 2108.5, 2012.0, 1900.0, 1792.5]}, 'Tiltil': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [317.0, 305.5, 295.5, 284.0, 273.5, 272.0, 286.5, 309.0, 318.0, 314.0, 306.5, 301.5, 299.5, 298.0, 294.5, 286.0, 274.5]}, 'San Bernardo': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [4933.0, 4990.0, 4987.0, 4905.0, 4820.0, 4843.0, 5002.0, 5155.0, 5119.5, 4987.5, 4934.5, 4954.0, 5006.0, 5013.0, 4938.5, 4825.5, 4718.0]}, 'Buin': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1682.0, 1698.5, 1682.0, 1649.5, 1615.0, 1608.5, 1644.0, 1685.0, 1675.0, 1639.0, 1631.0, 1633.0, 1628.0, 1606.0, 1568.0, 1519.0, 1458.0]}, 'Calera de Tango': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [368.5, 373.0, 373.0, 373.0, 373.0, 378.5, 394.5, 416.0, 428.0, 431.5, 434.5, 435.0, 431.5, 421.5, 408.0, 396.0, 389.5]}, 'Paine': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1163.0, 1176.0, 1188.0, 1193.0, 1194.5, 1206.5, 1237.5, 1264.5, 1257.5, 1237.0, 1235.5, 1239.5, 1247.5, 1249.0, 1222.0, 1167.5, 1106.0]}, 'Melipilla': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1952.0, 1962.5, 1949.0, 1921.0, 1901.5, 1908.0, 1946.5, 1973.0, 1950.5, 1922.5, 1937.5, 1966.5, 1989.5, 1995.0, 1966.0, 1910.5, 1834.5]}, 'Alhué': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [102.5, 105.0, 103.0, 97.5, 93.0, 93.5, 96.5, 99.0, 99.0, 98.5, 99.5, 98.0, 93.5, 88.0, 82.0, 77.5, 75.5]}, 'Curacaví': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [502.0, 504.5, 498.0, 486.0, 478.5, 480.0, 492.0, 502.0, 497.5, 489.0, 489.0, 490.5, 490.0, 487.0, 479.0, 466.0, 447.0]}, 'María Pinto': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [202.0, 202.5, 198.5, 191.0, 188.5, 193.5, 206.0, 217.0, 213.5, 203.0, 197.0, 199.0, 204.5, 206.0, 198.5, 186.0, 174.5]}, 'San Pedro': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [171.0, 167.0, 163.5, 159.5, 155.0, 152.5, 154.5, 157.5, 155.0, 152.5, 155.0, 159.5, 163.0, 162.5, 157.0, 145.5, 132.0]}, 'Talagante': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1173.0, 1180.5, 1171.5, 1145.0, 1122.5, 1126.0, 1159.0, 1187.0, 1173.5, 1148.0, 1146.5, 1157.0, 1169.0, 1171.0, 1152.5, 1117.5, 1075.0]}, 'El Monte': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [631.5, 634.0, 624.0, 603.0, 583.0, 575.0, 583.5, 594.5, 591.0, 581.0, 576.0, 573.5, 573.5, 569.0, 555.5, 536.5, 517.0]}, 'Isla de Maipo': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [583.5, 589.5, 584.0, 569.0, 557.0, 559.5, 582.5, 607.5, 608.5, 594.5, 590.0, 594.5, 600.0, 597.0, 583.5, 560.0, 530.5]}, 'Padre Hurtado': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1226.0, 1234.0, 1210.0, 1152.5, 1096.0, 1073.0, 1097.5, 1136.0, 1139.0, 1118.5, 1110.0, 1115.0, 1124.5, 1119.5, 1088.0, 1042.5, 998.5]}, 'Peñaflor': {'rango': ['1-2', '2-3', '3-4', '4-5', '5-6', '6-7', '7-8', '8-9', '9-10', '10-11', '11-12', '12-13', '13-14', '14-15', '15-16', '16-17', '17-18'], 'promedio': [1472.5, 1459.5, 1447.5, 1428.0, 1411.5, 1418.5, 1462.5, 1508.0, 1509.0, 1494.0, 1505.5, 1517.0, 1513.5, 1495.5, 1465.0, 1424.5, 1365.5]}};

const select = document.getElementById('comuna-select');
const plotDiv = document.getElementById('plot');

// Poblar el dropdown
Object.keys(dataPorComuna).sort().forEach(comuna => {
    const option = document.createElement('option');
    option.value = comuna;
    option.text = comuna;
    select.appendChild(option);
});

// Función para graficar
function graficar(comuna) {
    const datos = dataPorComuna[comuna];
    const trace = {
        x: datos.rango,
        y: datos.promedio,
        type: 'bar',
        marker: {color: '#337ab7'}
    };

    const layout = {
        title: 'Población por Rango Etario en ' + comuna,
        xaxis: { title: 'Rango Etario', type: 'category' },
        yaxis: { title: 'Población Promedio' }
    };

    Plotly.newPlot(plotDiv, [trace], layout);
}

// Evento de cambio
select.addEventListener('change', (e) => {
    graficar(e.target.value);
});

// Inicial
graficar(select.value = Object.keys(dataPorComuna)[0]);
</script>

</body>
</html>
